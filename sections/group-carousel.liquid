{% comment %}
  Group carousel section â€” vGC-1.1.0
  - Base on vGC-1.0.1
  - New: slide_width / slide_height settings to control item size
{% endcomment %}

{% liquid
  assign slide_count = section.blocks.size
  assign slide_width = section.settings.slide_width | default: 0
  assign slide_height = section.settings.slide_height | default: 0
%}

<div class="section-background color-{{ section.settings.color_scheme }}"></div>

<div
  class="
    section
    section--{{ section.settings.section_width }}
    color-{{ section.settings.color_scheme }}
    section-group-carousel
    spacing-style
    gap-style
  "
  style="
    {% render 'spacing-style', settings: section.settings %}
    {% render 'gap-style', value: section.settings.gap %}
  "
>
  {% if slide_count > 0 %}
    {%- capture list_items -%}
      {%- for block in section.blocks -%}
        <div
          class="resource-list__item group-carousel__item"
          style="
            {% if slide_width > 0 %}
              width: {{ slide_width }}px;
              flex: 0 0 {{ slide_width }}px;
            {% endif %}
            {% if slide_height > 0 %}
              min-height: {{ slide_height }}px;
            {% endif %}
          "
          {{ block.shopify_attributes }}
        >
          {% render block %}
        </div>

        {% unless forloop.last %}
          <!--@list/split-->
        {% endunless %}
      {%- endfor -%}
    {%- endcapture -%}

    {% liquid
      assign list_items_array = list_items | strip | split: '<!--@list/split-->'
    %}

    {% render 'resource-list',
      list_items: list_items,
      list_items_array: list_items_array,
      settings: section.settings,
      slide_count: slide_count,
      content_type: 'groups',
      test_id: 'group-carousel'
    %}
  {% else %}
    <div class="group-carousel__empty">
      Add a Group block to create your first slide.
    </div>
  {% endif %}
</div>

{% schema %}
{
  "name": "t:names.group_carousel",
  "class": "section-group-carousel",
  "max_blocks": 16,
  "blocks": [
    {
      "type": "@theme"
    },
    {
      "type": "@app"
    }
  ],
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "header",
      "content": "Carousel layout"
    },
    {
      "type": "select",
      "id": "layout_type",
      "label": "t:settings.layout_type",
      "options": [
        {
          "value": "carousel",
          "label": "t:options.carousel"
        }
      ],
      "default": "carousel"
    },

    {
      "type": "range",
      "id": "columns",
      "label": "t:settings.columns",
      "min": 1,
      "max": 4,
      "step": 1,
      "default": 1
    },
    {
      "type": "select",
      "id": "mobile_card_size",
      "label": "t:settings.mobile_columns",
      "options": [
        {
          "value": "60cqw",
          "label": "t:options.one_number"
        },
        {
          "value": "44cqw",
          "label": "t:options.two_number"
        }
      ],
      "default": "60cqw"
    },
    {
      "type": "range",
      "id": "columns_gap",
      "label": "t:settings.horizontal_gap",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 12
    },

    {
      "type": "header",
      "content": "Slide sizing"
    },
    {
      "type": "range",
      "id": "slide_width",
      "label": "Slide width",
      "min": 0,
      "max": 800,
      "step": 10,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "slide_height",
      "label": "Slide min height",
      "min": 0,
      "max": 800,
      "step": 10,
      "unit": "px",
      "default": 0
    },

    {
      "type": "header",
      "content": "t:content.carousel_navigation"
    },
    {
      "type": "select",
      "id": "icons_style",
      "label": "t:settings.icon",
      "options": [
        {
          "value": "arrow",
          "label": "t:options.arrows"
        },
        {
          "value": "chevron",
          "label": "t:options.chevrons"
        },
        {
          "value": "arrows_large",
          "label": "t:options.arrows_large"
        },
        {
          "value": "chevron_large",
          "label": "t:options.chevron_large"
        },
        {
          "value": "none",
          "label": "t:options.none"
        }
      ],
      "default": "arrow"
    },
    {
      "type": "select",
      "id": "icons_shape",
      "label": "t:settings.icon_background",
      "options": [
        {
          "value": "none",
          "label": "t:options.none"
        },
        {
          "value": "circle",
          "label": "t:options.circle"
        },
        {
          "value": "square",
          "label": "t:options.square"
        }
      ],
      "default": "none"
    },
    {
      "type": "header",
      "content": "t:content.section_layout"
    },
    {
      "type": "select",
      "id": "section_width",
      "label": "t:settings.width",
      "options": [
        {
          "value": "page-width",
          "label": "t:options.page"
        },
        {
          "value": "full-width",
          "label": "t:options.full"
        }
      ],
      "default": "page-width"
    },
    {
      "type": "range",
      "id": "gap",
      "label": "t:settings.gap",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 28
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:settings.color_scheme",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "t:content.padding"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "label": "t:settings.top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 48
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "label": "t:settings.bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 48
    }
  ],
  "presets": [
    {
      "name": "t:names.group_carousel",
      "category": "t:categories.layout",
      "blocks": [
        {
          "type": "group"
        }
      ]
    }
  ]
}
{% endschema %}
