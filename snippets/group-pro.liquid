{%- comment -%}
  Snippet: group-pro â€” vGP-1.3.0
  - æ‰©å±•è‡ª snippets/group.liquid
  - æ–°å¢žï¼š
    - position_mode: static / relative / absolute
    - position_top / position_left (ä»… absolute æœ‰æ•ˆ)
    - absolute_size_enabled + absolute_width_mode + absolute_width_custom + absolute_aspect_ratio
      ðŸ‘‰ Static / Relative / Absolute éƒ½ä¼šåº”ç”¨ Absolute size (pro)
    - enable_glow + glow_color + glow_blur + glow_spread
{%- endcomment -%}

{%- liquid
  assign position_mode = settings.position_mode | default: 'static'
  assign position_style = ''

  if position_mode == 'relative'
    assign position_style = 'position: relative;'
  elsif position_mode == 'absolute'
    assign position_style = 'position: absolute;'
  else
    assign position_style = 'position: static;'
  endif

  if position_mode == 'absolute'
    if settings.position_top != blank
      assign position_style = position_style | append: ' top: ' | append: settings.position_top | append: '%;'
    endif
    if settings.position_left != blank
      assign position_style = position_style | append: ' left: ' | append: settings.position_left | append: '%;'
    endif
  endif

  assign abs_size_style = ''

  if settings.absolute_size_enabled
    assign width_mode = settings.absolute_width_mode | default: 'fill'

    if width_mode == 'fill'
      assign abs_size_style = abs_size_style | append: ' width: 100%;'
    elsif width_mode == 'custom'
      assign custom_w = settings.absolute_width_custom | default: 100
      assign abs_size_style = abs_size_style | append: ' width: ' | append: custom_w | append: '%;'
    endif

    assign ar = settings.absolute_aspect_ratio | default: 'none'

    case ar
      when '1-1'
        assign abs_size_style = abs_size_style | append: ' aspect-ratio: 1 / 1;'
      when '4-3'
        assign abs_size_style = abs_size_style | append: ' aspect-ratio: 4 / 3;'
      when '3-4'
        assign abs_size_style = abs_size_style | append: ' aspect-ratio: 3 / 4;'
      when '16-9'
        assign abs_size_style = abs_size_style | append: ' aspect-ratio: 16 / 9;'
      when '9-16'
        assign abs_size_style = abs_size_style | append: ' aspect-ratio: 9 / 16;'
    endcase
  endif

  assign glow_style = ''
  if settings.enable_glow
    assign blur = settings.glow_blur | default: 30
    assign spread = settings.glow_spread | default: 0
    assign color = settings.glow_color | default: '#00000033'
    assign glow_style = ' box-shadow: 0 0 ' | append: blur | append: 'px ' | append: spread | append: 'px ' | append: color | append: ';'
  endif
-%}

<div
  class="
    group-block
    group-block-pro
    group-block--height-{{ settings.height }}
    group-block--width-{{ settings.width }}
    border-style
    spacing-style
    size-style
    {% if settings.inherit_color_scheme == false %} color-{{ settings.color_scheme }}{% endif %}
    {{ class }}
  "
  style="
    {% render 'border-override', settings: settings %}
    {% render 'spacing-style', settings: settings %}
    {% render 'size-style', settings: settings %}
    {{ position_style }}
    {{ abs_size_style }}
    {{ glow_style }}
    {{ style }}
  "
  {{ shopify_attributes }}
  data-testid="group-block-pro"
>
  {%- if settings.link != blank -%}
    <a
      href="{{ settings.link }}"
      class="group-block__link"
      {% if settings.open_in_new_tab %}
        target="_blank" rel="noopener"
      {% endif %}
    ></a>
  {%- endif -%}

  <div class="group-block__media-wrapper">
    {% render 'background-media',
      background_media: settings.background_media,
      background_video: settings.video,
      background_video_position: settings.video_position,
      background_image: settings.background_image,
      background_image_position: settings.background_image_position,
      placeholder: settings.placeholder
    %}
    {% if settings.toggle_overlay %}
      {% render 'overlay', settings: settings, layer: '0' %}
    {% endif %}
  </div>

  <div
    class="
      group-block-content
      {% if request.design_mode %}group-block-content--design-mode{% endif %}
      layout-panel-flex
      layout-panel-flex--{{ settings.content_direction | default: 'column' }}
      {% if settings.vertical_on_mobile %} mobile-column{% endif %}
    "
    style="{% render 'layout-panel-style', settings: settings %}"
  >
    {{- children -}}
  </div>
</div>

{% stylesheet %}
  .group-block__link {
    position: absolute;
    inset: 0;
  }

  .group-block__link ~ :is(.group-block-content, .group-block__media-wrapper) {
    pointer-events: none;

    :is(a, button, input, textarea, select) {
      pointer-events: auto;
    }
  }

  /* Needs the .group-block__link ~ to be specific enough to take effect. */
  .group-block__link ~ .group-block-content--design-mode {
    pointer-events: auto;
  }
{% endstylesheet %}
