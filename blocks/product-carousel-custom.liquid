{% comment %}
  Group carousel (block) — vGCB-1.0.0
  - 在一个 block 里面横向展示多个子 block（如 Product card）
  - 使用原生横向滚动 + scroll-snap
{% endcomment %}

<div
  class="block-group-carousel"
  style="
    --group-carousel-slide-width: {{ block.settings.slide_width }}px;
    --group-carousel-gap: {{ block.settings.gap }}px;
  "
  {{ block.shopify_attributes }}
>
  {% if block.settings.show_heading and block.settings.heading != blank %}
    <div class="block-group-carousel__heading">
      <h3 class="block-group-carousel__title">
        {{ block.settings.heading }}
      </h3>
    </div>
  {% endif %}

  <div class="block-group-carousel__viewport">
    <div class="block-group-carousel__track">
      {%- comment -%}
        这里会输出所有“子 block”的 HTML：
        比如 Product card、Image、Text 等。
        它们会作为 .block-group-carousel__track 的直接子元素，
        被 flex 横向排列。
      {%- endcomment -%}
      {% content_for 'blocks' %}
    </div>
  </div>
</div>

{% style %}
  .block-group-carousel {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .block-group-carousel__title {
    margin: 0;
  }

  .block-group-carousel__viewport {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scroll-snap-type: x mandatory;
  }

  .block-group-carousel__track {
    display: flex;
    gap: var(--group-carousel-gap, 16px);
    padding-block: 0.25rem;
  }

  /* 每一个子 block（例如 Product card）变成一张 slide */
  .block-group-carousel__track > * {
    flex: 0 0 var(--group-carousel-slide-width, 260px);
    min-width: var(--group-carousel-slide-width, 260px);
    scroll-snap-align: start;
  }

  /* 移动端：一屏大约一张卡 */
  @media (max-width: 749px) {
    .block-group-carousel__track > * {
      flex-basis: 80%;
      min-width: 80%;
    }
  }
{% endstyle %}

{% schema %}
{
  "name": "Group carousel (block)",
  "blocks": [
    { "type": "@theme" },
    { "type": "@app" }
  ],
  "settings": [
    {
      "type": "checkbox",
      "id": "show_heading",
      "label": "Show heading",
      "default": false
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Group carousel"
    },
    {
      "type": "header",
      "content": "Slide layout"
    },
    {
      "type": "range",
      "id": "slide_width",
      "label": "Slide width",
      "min": 180,
      "max": 600,
      "step": 10,
      "unit": "px",
      "default": 260
    },
    {
      "type": "range",
      "id": "gap",
      "label": "Horizontal gap",
      "min": 0,
      "max": 64,
      "step": 2,
      "unit": "px",
      "default": 16
    }
  ],
  "presets": [
    {
      "name": "Group carousel (block)"
    }
  ]
}
{% endschema %}
