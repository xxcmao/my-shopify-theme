{% comment %}
  Group carousel (block) — vGCB-1.0.2
  - 容器 block：把内部子 block 变成横向滑动的 slides
  - 使用方式：在任意支持自定义 blocks 的 section 里「Add block」→ 选择本控件
{% endcomment %}

{%- capture children -%}
  {% content_for 'blocks' %}
{%- endcapture -%}

<div
  class="group-carousel-block"
  style="--gcb-gap: {{ block.settings.columns_gap }}px;"
  {{ block.shopify_attributes }}
>
  {%- if block.settings.show_heading and block.settings.heading != blank -%}
    <div class="group-carousel-block__heading">
      <h3 class="group-carousel-block__title">
        {{ block.settings.heading }}
      </h3>
    </div>
  {%- endif -%}

  <div class="group-carousel-block__viewport">
    <div class="group-carousel-block__track">
      {{ children }}
    </div>
  </div>
</div>

{% style %}
  .group-carousel-block {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    width: 100%;
  }

  .group-carousel-block__heading {
    width: 100%;
  }

  .group-carousel-block__title {
    margin: 0;
  }

  .group-carousel-block__viewport {
    width: 100%;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scroll-snap-type: x mandatory;
  }

  .group-carousel-block__track {
    display: flex;
    gap: var(--gcb-gap, 16px);
    padding-block: 0.25rem;
  }

  /* 每个内部 block == 一个 slide，填满容器宽度 */
  .group-carousel-block__track > * {
    flex: 0 0 100%;
    min-width: 100%;
    scroll-snap-align: start;
  }

  /* 让 Product card 之类的内容也铺满 */
  .group-carousel-block .product-card,
  .group-carousel-block .resource-list__item {
    width: 100%;
    max-width: none;
  }

  @media (max-width: 749px) {
    .group-carousel-block__track > * {
      flex-basis: 100%;
      min-width: 100%;
    }
  }
{% endstyle %}

{% schema %}
{
  "name": "Group carousel (block)",
  "blocks": [
    { "type": "@theme" },
    { "type": "@app" },
    { "type": "_divider" }
  ],
  "settings": [
    {
      "type": "checkbox",
      "id": "show_heading",
      "label": "Show heading",
      "default": false
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Featured",   // 不能是空字符串
      "placeholder": "Heading"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "columns_gap",
      "label": "Horizontal gap",
      "min": 0,
      "max": 64,
      "step": 2,
      "unit": "px",
      "default": 16
    }
  ]
}
{% endschema %}
